<!DOCTYPE html>
<html lang="en">
<head>
	<!-- Basic Metas -->
	<meta charset="utf-8">
	<title>The Power of AppleScript | Kevin Yap</title>
	<meta name="description" content="One of my favourite genres of music is video game music. Because of this, it was no surprise that I was ecstatic when OverClocked ReMix announced that ReMixes 1-2500 were available to download via torrent, and that every file contained “complete and consistent ID3 tags”. While the tags for most ...">
	<meta name="author" content="Kevin Yap">
	<link rel="author" href="https://plus.google.com/+KevinYapCA"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<!-- Twitter Cards and Open Graph -->
	<meta name="twitter:card" content="summary">
	<meta name="twitter:creator" content="@iKevinY">
	<meta name="twitter:domain" content="kevinyap.ca">
	<meta name="twitter:site" content="@iKevinY">
	<meta property="og:title" content="The Power of AppleScript">
	<meta property="og:description" content="One of my favourite genres of music is video game music. Because of this, it was no surprise that I was ecstatic when OverClocked ReMix announced that ReMixes 1-2500 were available to download via torrent, and that every file contained “complete and consistent ID3 tags”. While the tags for most ...">
	<meta property="og:image" content="http://kevinyap.ca/theme/images/avatar512.png">
	<meta property="og:type" content="article">
	<meta property="og:url" content="http://kevinyap.ca/2012/11/the-power-of-applescript/">

	<!-- Stylesheets and Web Fonts -->
	<link href="/theme/style.min.css" rel="stylesheet">
	<link href="//fonts.googleapis.com/css?family=Merriweather|Open+Sans|Source+Code+Pro" rel="stylesheet" type="text/css">
	<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

	<!-- Favicons -->
	<link rel="apple-touch-icon" href="/theme/images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="57x57" href="/theme/images/apple-touch-icon-57x57.png">
	<link rel="apple-touch-icon" sizes="60x60" href="/theme/images/apple-touch-icon-60x60.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/theme/images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="76x76" href="/theme/images/apple-touch-icon-76x76.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/theme/images/apple-touch-icon-114x114.png">
	<link rel="apple-touch-icon" sizes="120x120" href="/theme/images/apple-touch-icon-120x120.png">
	<link rel="apple-touch-icon" sizes="144x144" href="/theme/images/apple-touch-icon-144x144.png">
	<link rel="apple-touch-icon" sizes="152x152" href="/theme/images/apple-touch-icon-152x152.png">

	<link rel="icon" type="image/png" href="/theme/images/favicon-16x16.png" sizes="16x16">
	<link rel="icon" type="image/png" href="/theme/images/favicon-32x32.png" sizes="32x32">
	<link rel="icon" type="image/png" href="/theme/images/favicon-96x96.png" sizes="96x96">
	<link rel="icon" type="image/png" href="/theme/images/favicon-160x160.png" sizes="160x160">
	<link rel="icon" type="image/png" href="/theme/images/favicon-196x196.png" sizes="196x196">

	<meta name="application-name" content="Kevin Yap">
	<meta name="msapplication-TileColor" content="#da532c">
	<meta name="msapplication-TileImage" content="theme/images/mstile-144x144.png">
	<meta name="msapplication-square70x70logo" content="theme/images/mstile-small.png">
	<meta name="msapplication-square150x150logo" content="theme/images/mstile-medium.png">
	<meta name="msapplication-wide310x150logo" content="theme/images/mstile-wide.png">
	<meta name="msapplication-square310x310logo" content="theme/images/mstile-large.png">

	<!--[if lt IE 9]>
	<script src="/theme/js/html5shiv.min.js"></script>
	<script src="/theme/js/respond.min.js"></script>
	<![endif]-->
</head>

<body>
	<div class="container">
		<aside id="sidebar" class="side-column">
			<a href="/"><img id="avatar" alt="Site Avatar" src="/theme/images/avatar.png"></a>
			<div id="logo" class="text-center"><a href="/">Kevin Yap</a></div>
			<div id="bio" class="text-center">Developer and musician from Vancouver, BC.</div>

			<div id="sidebar-links" class="text-center">
				<a href="/about/">About</a>&ensp;&bull;&ensp;<a href="/projects/">Projects</a>
			</div>

			<div id="social" class="text-center">
				<a href="m&#97;&#105;l&#116;o&#58;me&#64;&#107;e&#118;inya&#112;&#46;ca" title="Email" class="icon fa fa-envelope"></a>
				<a href="http://twitter.com/iKevinY" title="Twitter" class="icon fa fa-twitter"></a>
				<a href="http://plus.google.com/+KevinYapCA" title="Google+" class="icon fa fa-google-plus-square"></a>
				<a href="http://github.com/iKevinY" title="GitHub" class="icon fa fa-github"></a>
				<a href="http://soundcloud.com/iKevinY" title="SoundCloud" class="icon fa fa-soundcloud"></a>
			</div>

			<hr id="sidebar-divider" class="large">
		</aside>

		<article class="main-column">
	<h1 class="title"><a href="/2012/11/the-power-of-applescript/" title="Permalink to The Power of AppleScript">The Power of&nbsp;AppleScript</a></h1>
	<time class="date" datetime="2012-11-28 00:00:00-08:00">November 28, 2012</time>
	<div class="content">
		<p>One of my favourite genres of music is video game music. Because of this, it was no surprise that I was ecstatic when OverClocked ReMix announced that ReMixes 1-2500 were available to download via torrent, and that every file contained &#8220;complete and consistent <span class="caps">ID3</span> tags&#8221;. While the tags for most fields are great, I wasn&#8217;t particularly fond of the format of the track titles. Instead of <em>TrackName (GameName)</em> like I would have preferred, the format was <em>GameName &#8216;TrackName&#8217; <span class="caps">OC</span> ReMix</em>. There are a few reasons why I don&#8217;t like the provided format (namely that the &#8220;<span class="caps">OC</span> ReMix&#8221; suffix feels redundant to me and it feels more appropriate to not see the songs grouped by their source game), but that&#8217;s besides the&nbsp;point.</p>
<p>Obviously, manually renaming nearly 2500 tracks in iTunes would be a ridiculous undertaking. Luckily, AppleScript happens to be the perfect tool to automate this task. While I had never used AppleScript previous to this, the syntax was easy enough to learn quickly. <a href="http://dougscripts.com/itunes/">Doug&#8217;s AppleScripts for iTunes</a> proved itself to be a useful resource for learning (and happens to be where I downloaded other scripts from in the past). It is also where I derived the skeleton of this script from. At first, I attempted to figured out how to handle regular expressions within strings in AppleScript, but I soon realized that a crude piece of code would work just as well; it just wouldn&#8217;t be useful for any other situation. I set off in search of AppleScript documentation to learn to to manipulate the track name string in the way that I&nbsp;wanted.</p>
<p>The easiest part of the track title to manipulate was removing the <em><span class="caps">OC</span> ReMix</em> text at the end of every track. The way I did it was by setting the track name track to itself after removing 9 characters from the end of the string (as it includes the leading space character). With AppleScript, this was very easy to do: <code>set trackName to text 1 thru -10 of trackName</code> (<code>-1</code> represents the last character in the string, so <code>-2</code> would remove the last character, and so&nbsp;on).</p>
<p>After that, to search for the part of the string that contained the song name, I initially tried looking for the first apostrophe in the track title and used the next character as the beginning of the song name string, and ended the string one character before the end of the track title. In most cases, this would (as expected) take the text between the apostrophes &#8212; the song name &#8212; and store it in a dedicated song name string. Great! Fortunately, I tested this script in batches of 10 tracks or so at a time and manually vetted the result, as this definitely did not work. The flaw with this method may already be obvious; if the game name itself contained an apostrophe (for example, Legend of Zelda: Link&#8217;s Awakening), the script would use all the characters after this apostrophe until the final apostrophe as the song name, which is&nbsp;incorrect.</p>
<p>The fix for this was simple enough. Instead of searching for the first apostrophe within the track title, I searched for the first space followed directly by an apostrophe, and altered the values that affect the length of the strings&nbsp;accordingly.</p>
<p>All in all, the script was certainly not pretty, but it did the job. I didn&#8217;t notice any incorrectly reformatted names at first glance, but it is possible that a few oddly named songs were incorrectly renamed. I guess my point is that AppleScript was easy enough to work with (given rudimentary knowledge of how other programming languages function) that I was able to hack this very specifically-purposed script together in a short amount of time. Most of the code is based on words in English making it accessible to people who have never programmed before, and the AppleScript Editor gives an alert when saving or running the code if it is&nbsp;invalid.</p>
<p>If you want to use the script to rename to your own tracks (or just to examine my shoddily thrown together code), here is the source code; to use the script, copy it into AppleScript Editor, select the tracks in iTunes, and run&nbsp;it.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="codehilite"><pre><span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;iTunes&quot;</span>
    <span class="k">set</span> <span class="nv">sel</span> <span class="k">to</span> <span class="nv">selection</span>
    <span class="k">if</span> <span class="nv">sel</span> <span class="ow">is not</span> <span class="p">{}</span> <span class="k">then</span>
        <span class="k">repeat</span> <span class="nv">with</span> <span class="nv">track</span> <span class="k">in</span> <span class="nv">sel</span>
            <span class="c">-- Set trackName variable to name of track (track)</span>
            <span class="k">set</span> <span class="nv">trackName</span> <span class="k">to</span> <span class="p">(</span><span class="k">get</span> <span class="na">name</span> <span class="k">of</span> <span class="nv">track</span><span class="p">)</span>
            <span class="c">-- Strip &quot; OC ReMix&quot; characters from end of track title</span>
            <span class="k">set</span> <span class="nv">trackName</span> <span class="k">to</span> <span class="nb">text</span> <span class="mi">1</span> <span class="nb">thru</span> <span class="o">-</span><span class="mi">10</span> <span class="k">of</span> <span class="nv">trackName</span>
            <span class="c">-- Find the location in the string where the song name begins (-2)</span>
            <span class="k">set</span> <span class="nv">songTitleBegins</span> <span class="k">to</span> <span class="p">(</span><span class="nb">offset</span> <span class="k">of</span> <span class="s2">&quot; &#39;&quot;</span> <span class="k">in</span> <span class="nv">trackName</span><span class="p">)</span>
            <span class="c">-- Store name of song in songName string</span>
            <span class="k">set</span> <span class="nv">songName</span> <span class="k">to</span> <span class="nb">text</span> <span class="p">((</span><span class="nv">songTitleBegins</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="nb">thru</span> <span class="o">-</span><span class="mi">2</span> <span class="k">of</span> <span class="nv">trackName</span>
            <span class="c">-- Find name of game</span>
            <span class="k">set</span> <span class="nv">gameTitle</span> <span class="k">to</span> <span class="nb">text</span> <span class="mi">1</span> <span class="nb">thru</span> <span class="p">(</span><span class="nv">songTitleBegins</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">of</span> <span class="nv">trackName</span>
            <span class="c">-- Format new track name</span>
            <span class="k">set</span> <span class="nv">newTrackName</span> <span class="k">to</span> <span class="nv">songName</span> <span class="o">&amp;</span> <span class="s2">&quot; &quot;</span> <span class="o">&amp;</span> <span class="s2">&quot;(&quot;</span> <span class="o">&amp;</span> <span class="nv">gameTitle</span> <span class="o">&amp;</span> <span class="s2">&quot;)&quot;</span>
            <span class="c">-- Set name of track to newly formatted track name</span>
            <span class="k">set</span> <span class="na">name</span> <span class="k">of</span> <span class="nv">track</span> <span class="k">to</span> <span class="nv">newTrackName</span>
        <span class="k">end</span> <span class="k">repeat</span>
    <span class="k">end</span> <span class="k">if</span>
<span class="k">end</span> <span class="k">tell</span>
</pre></div>
</td></tr></table>
	</div>

	<div id="related-articles">
		<a href="/2013/07/the-great-white-pelican-migration/" id="next-neighbour">&laquo; The Great (White) Pelican Migration</a>
		<a href="/2011/10/hello-blogosphere/" id="prev-neighbour">Hello, Blogosphere! &raquo;</a>
	</div>

	<hr class="large">

	<!-- Disqus -->
	<div id="disqus_thread"></div>
	<script type="text/javascript">
		var disqus_shortname = 'kevinyap';
		(function() {
			var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
			dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
			(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
		})();
	</script>
			<hr class="large">
		</article>

		<footer class="main-column">
			<p>Powered by <a href="http://getpelican.com">Pelican</a> and <a href="http://pages.github.com">GitHub&nbsp;Pages</a>.</p>
		</footer>
	</div>

	<!-- Google Analytics -->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-41937659-1', 'kevinyap.ca');
		ga('send', 'pageview');
	</script>

</body>
</html>